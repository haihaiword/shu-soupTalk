"use strict";const e=require("../../common/vendor.js"),o=require("../../common/assets.js"),u=require("../../stores/user.js"),t=require("../../utils/tools.js");if(!Array){(e.resolveComponent("uni-icons")+e.resolveComponent("uni-list-item")+e.resolveComponent("uni-list")+e.resolveComponent("uni-popup-dialog")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../uni_modules/uni-list/components/uni-list-item/uni-list-item.js")+(()=>"../../uni_modules/uni-list/components/uni-list/uni-list.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();const n={__name:"edit",setup(n){const l=u.useUserStore(),a=e.computed((()=>l.userInfo)),i=e.ref(null),s=e.ref(null),r=e.ref(l.userInfo.gender||0),p=e.ref(l.userInfo.avatar),c=e.ref(!1),d=e.ref(0),v=e.ref([{value:0,text:"保密"},{value:1,text:"男"},{value:2,text:"女"}]);function f(o){c.value=!0,p.value=o.detail.avatarUrl,e.Vs.uploadFile({filePath:p.value,cloudPath:`userAvatar/${t.formatDate(Date.now(),"yyyyMMdd")}/${Date.now()}.jpg`,cloudPathAsRealPath:!0,onUploadProgress:function(e){console.log(e),d.value=Math.round(100*e.loaded/e.total)}}).then((e=>{p.value=e.fileID,console.log(e.fileID),l.updateUserInfo({avatar:p.value}),c.value=!1}))}function m(){i.value.open()}function g(){s.value.open()}function h(){}function _(e){r.value=Number(e.detail.value)}function x(){l.updateUserInfo({gender:r.value})}function w(o){console.log(o),e.index.showLoading(),l.updateUserInfo({username:o})}return(u,n)=>e.e({a:p.value},p.value?{b:p.value}:{c:o._imports_0$2},{d:e.o(f),e:c.value},c.value?{f:e.t(d.value)}:{},{g:e.p({type:"camera",color:"#fff",size:"16"}),h:e.o((o=>{return u="userInfo._id",console.log(u),void e.index.setClipboardData({data:u,success:e=>{console.log("成功")},fail:e=>{console.log("失败")}});var u})),i:e.p({showArrow:!0,title:"用户ID",clickable:!0,rightText:a.value._id}),j:e.o(m),k:e.p({showArrow:!0,title:"昵称",clickable:!0,rightText:a.value.username}),l:e.o(g),m:e.p({showArrow:!0,title:"性别",clickable:!0,rightText:e.unref(t.formatGender)(a.value.gender)}),n:e.o(h),o:e.p({showArrow:!0,title:"注册时间",rightText:e.unref(t.formatDate)(a.value.register_date)}),p:e.o(w),q:e.p({mode:"input",maxlength:"15",title:"修改昵称",value:a.value.username,placeholder:"请输入昵称"}),r:e.sr(i,"35438779-6",{k:"usernamePopup"}),s:e.p({type:"dialog"}),t:e.f(v.value,((o,u,t)=>({a:o.value,b:r.value==o.value,c:e.t(o.text),d:o.value}))),v:e.o(_),w:e.o(x),x:e.p({title:"修改性别",mode:"input"}),y:e.sr(s,"35438779-8",{k:"genderPopup"}),z:e.p({type:"dialog"})})}},l=e._export_sfc(n,[["__scopeId","data-v-35438779"]]);wx.createPage(l);
